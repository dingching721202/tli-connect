<!DOCTYPE html>
<html>
<head>
    <title>課程連結修復測試</title>
    <meta charset="utf-8">
</head>
<body>
    <h1>🔗 課程連結修復測試</h1>
    
    <div id="results"></div>
    
    <script>
        // 模擬課程連結驗證函數
        function isValidLink(link) {
            if (!link || link.trim() === '') return false;
            
            // 檢查是否為佔位符連結
            const placeholderLinks = [
                'https://meet.google.com/course-session',
                'https://example.com/classroom',
                'https://placeholder.com',
                'https://your-classroom-link.com',
                'https://your-material-link.com'
            ];
            
            if (placeholderLinks.includes(link.trim())) {
                return false;
            }
            
            // 檢查是否為有效的URL或路徑
            try {
                // URL格式檢查
                if (link.startsWith('http://') || link.startsWith('https://')) {
                    new URL(link);
                    return true;
                }
                
                // 相對路徑檢查
                if (link.startsWith('/') || link.startsWith('./') || link.startsWith('../')) {
                    return true;
                }
                
                // 檔案名稱檢查
                if (link.includes('.')) {
                    return true;
                }
                
                return false;
            } catch {
                return false;
            }
        }
        
        // 測試案例
        const testCases = [
            { link: 'https://meet.google.com/course-session', expected: false, description: '預設佔位符教室連結' },
            { link: '', expected: false, description: '空字符串' },
            { link: null, expected: false, description: 'null值' },
            { link: 'https://meet.google.com/abc-def-ghi', expected: true, description: '真實Google Meet連結' },
            { link: 'https://zoom.us/j/123456789', expected: true, description: '真實Zoom連結' },
            { link: '/materials/lesson1.pdf', expected: true, description: '相對路徑PDF' },
            { link: 'lesson1.pdf', expected: true, description: '檔案名稱' },
            { link: 'https://example.com/classroom', expected: false, description: '示例佔位符連結' }
        ];
        
        const results = document.getElementById('results');
        let allPassed = true;
        
        testCases.forEach((testCase, index) => {
            const result = isValidLink(testCase.link);
            const passed = result === testCase.expected;
            allPassed = allPassed && passed;
            
            const resultDiv = document.createElement('div');
            resultDiv.style.padding = '10px';
            resultDiv.style.margin = '5px';
            resultDiv.style.border = '1px solid #ccc';
            resultDiv.style.backgroundColor = passed ? '#e8f5e8' : '#ffe8e8';
            
            resultDiv.innerHTML = `
                <strong>測試 ${index + 1}: ${testCase.description}</strong><br>
                連結: "${testCase.link}"<br>
                預期: ${testCase.expected}<br>
                實際: ${result}<br>
                結果: <span style="color: ${passed ? 'green' : 'red'}">${passed ? '✅ 通過' : '❌ 失敗'}</span>
            `;
            
            results.appendChild(resultDiv);
        });
        
        // 總結
        const summary = document.createElement('div');
        summary.style.padding = '15px';
        summary.style.margin = '10px 0';
        summary.style.border = '2px solid ' + (allPassed ? 'green' : 'red');
        summary.style.backgroundColor = allPassed ? '#e8f5e8' : '#ffe8e8';
        summary.innerHTML = `
            <h2>測試總結</h2>
            <p>總共 ${testCases.length} 個測試案例</p>
            <p style="color: ${allPassed ? 'green' : 'red'}">
                ${allPassed ? '🎉 所有測試通過！佔位符連結現在會被正確識別為無效連結。' : '❌ 有測試失敗，需要檢查邏輯。'}
            </p>
        `;
        
        results.insertBefore(summary, results.firstChild);
    </script>
</body>
</html>